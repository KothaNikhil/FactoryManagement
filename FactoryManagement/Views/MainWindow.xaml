<Window x:Class="FactoryManagement.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:views="clr-namespace:FactoryManagement.Views"
        xmlns:viewmodels="clr-namespace:FactoryManagement.ViewModels"
        mc:Ignorable="d"
        Title="Factory Management System" 
        Icon="pack://application:,,,/Images/factory-icon.ico"
        Height="800" Width="1400"
        WindowStartupLocation="CenterScreen"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        Background="{StaticResource BackgroundGradient}"
        FontFamily="Segoe UI, {materialDesign:MaterialDesignFont}"
        WindowState="Maximized"
        WindowStyle="None"
        AllowsTransparency="False"
        ResizeMode="CanResize"
        MaxHeight="{Binding Source={x:Static SystemParameters.MaximizedPrimaryScreenHeight}}"
        RenderOptions.BitmapScalingMode="HighQuality"
        RenderOptions.EdgeMode="Aliased"
        TextOptions.TextFormattingMode="Display"
        TextOptions.TextRenderingMode="ClearType"
        UseLayoutRounding="True"
        SnapsToDevicePixels="True">

    <Window.Resources>
        <DataTemplate DataType="{x:Type viewmodels:DashboardViewModel}">
            <views:DashboardView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type viewmodels:TransactionEntryViewModel}">
            <views:TransactionEntryView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type viewmodels:ReportsViewModel}">
            <views:ReportsView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type viewmodels:ItemsManagementViewModel}">
            <views:ItemsManagementView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type viewmodels:PartiesManagementViewModel}">
            <views:PartiesManagementView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type viewmodels:BackupViewModel}">
            <views:BackupView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type viewmodels:FinancialTransactionsViewModel}">
            <views:FinancialTransactionsView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type viewmodels:WagesManagementViewModel}">
            <views:WagesManagementView />
        </DataTemplate>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Custom Title Bar with Gradient -->
        <Border Grid.Row="0" Height="50" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="#1a1a2e" Offset="0"/>
                    <GradientStop Color="#16213e" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <DockPanel>
                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal">
                    <Button Width="50" Height="50" Style="{StaticResource MaterialDesignFlatButton}" 
                            Click="MinimizeButton_Click" Foreground="White">
                        <materialDesign:PackIcon Kind="WindowMinimize" Width="18" Height="18"/>
                    </Button>
                    <Button x:Name="MaximizeButton" Width="50" Height="50" Style="{StaticResource MaterialDesignFlatButton}" 
                            Click="MaximizeButton_Click" Foreground="White">
                        <materialDesign:PackIcon x:Name="MaximizeIcon" Kind="WindowMaximize" Width="18" Height="18"/>
                    </Button>
                    <Button Width="50" Height="50"
                            Click="CloseButton_Click" Foreground="White">
                        <Button.Style>
                            <Style TargetType="Button" BasedOn="{StaticResource MaterialDesignFlatButton}">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#f45c43"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                        <materialDesign:PackIcon Kind="Close" Width="18" Height="18"/>
                    </Button>
                </StackPanel>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0,0,0">
                    <Border Background="Transparent"
                            Width="36" Height="36" CornerRadius="8" Margin="0,0,12,0" VerticalAlignment="Center" HorizontalAlignment="Center">
                        <Image Width="24" Height="24" VerticalAlignment="Center" HorizontalAlignment="Center"
                               Source="pack://application:,,,/Images/factory-icon.ico"/>
                    </Border>
                    <TextBlock Text="Factory Management System" 
                               VerticalAlignment="Center" 
                               FontSize="16" 
                               FontWeight="SemiBold"
                               Foreground="White"/>
                </StackPanel>
            </DockPanel>
        </Border>
        
        <Grid Grid.Row="1">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Left Navigation Panel (Collapsible with Hover) -->
        <Border x:Name="NavigationBorder" 
                Grid.Column="0" 
                MouseEnter="NavigationBorder_MouseEnter"
                MouseLeave="NavigationBorder_MouseLeave">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                    <GradientStop Color="#16213e" Offset="0"/>
                    <GradientStop Color="#0f3460" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Border.Style>
                <Style TargetType="Border">
                    <Setter Property="Width" Value="280"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ElementName=PinToggle, Path=IsChecked}" Value="False">
                            <Setter Property="Width" Value="60"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
            
            <DockPanel>
                <!-- App Logo/Title with Pin Button -->
                <Border DockPanel.Dock="Top" Background="Transparent" Padding="16,20,16,20">
                    <DockPanel>
                        <!-- Expanded Header Content -->
                        <Button HorizontalAlignment="Left"
                                Background="Transparent"
                                BorderThickness="0"
                                Cursor="Hand"
                                Click="HamburgerButton_Click"
                                Padding="0"
                                Margin="-2,0,0,0">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Visibility" Value="Visible"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=PinToggle, Path=IsChecked}" Value="False">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                            <!-- Hamburger Menu Icon -->
                            <materialDesign:PackIcon Kind="Menu" 
                                                   Width="28" 
                                                   Height="28" 
                                                   Foreground="White"/>
                        </Button>
                        
                        <!-- Hidden PinToggle for collapsed state logic -->
                        <ToggleButton x:Name="PinToggle"
                                    Visibility="Collapsed"
                                    IsChecked="True"/>
                        
                        <!-- Collapsed State: Hamburger Menu Icon -->
                        <Button HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                Background="Transparent"
                                BorderThickness="0"
                                Cursor="Hand"
                                Click="HamburgerButton_Click"
                                Padding="0"
                                Margin="-2,0,0,0">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName=PinToggle, Path=IsChecked}" Value="False">
                                            <Setter Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                            <materialDesign:PackIcon Kind="Menu" 
                                                   Width="28" 
                                                   Height="28" 
                                                   Foreground="White"/>
                        </Button>
                    </DockPanel>
                </Border>

                <!-- Navigation Menu -->
                <ListBox x:Name="MenuListBox" 
                         Margin="0,20,0,20"
                         SelectionChanged="MenuListBox_SelectionChanged"
                         Background="Transparent"
                         BorderThickness="0"
                         SelectedIndex="0">
                    <ListBox.Resources>
                        <Style TargetType="ListBoxItem" BasedOn="{StaticResource MaterialDesignNavigationListBoxItem}">
                            <Setter Property="Padding" Value="16,14,16,14" />
                            <Setter Property="Margin" Value="8,4" />
                            <Setter Property="FontSize" Value="15" />
                            <Setter Property="Foreground" Value="White"/>
                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="ListBoxItem">
                                        <Border x:Name="Border" 
                                                Background="Transparent" 
                                                CornerRadius="12" 
                                                Padding="{TemplateBinding Padding}"
                                                Margin="{TemplateBinding Margin}">
                                            <ContentPresenter/>
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background">
                                                                <Setter.Value>
                                                                    <SolidColorBrush Color="White" Opacity="0.1"/>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter TargetName="Border" Property="Background" Value="{StaticResource PrimaryGradient}"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ListBox.Resources>

                    <ListBoxItem Tag="Dashboard">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="32"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <materialDesign:PackIcon Grid.Column="0" Kind="ViewDashboard" Width="28" Height="28" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White"/>
                            <TextBlock Grid.Column="1" Text="Dashboard" VerticalAlignment="Center" Margin="12,0,0,0" Foreground="White" FontWeight="Medium" FontSize="16">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="Visibility" Value="Visible"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=NavigationBorder, Path=Width}" Value="52">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </ListBoxItem>

                    <ListBoxItem Tag="TransactionEntry">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="32"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <materialDesign:PackIcon Grid.Column="0" Kind="CartPlus" Width="28" Height="28" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White"/>
                            <TextBlock Grid.Column="1" Text="Transaction Entry" VerticalAlignment="Center" Margin="12,0,0,0" Foreground="White" FontWeight="Medium" FontSize="16">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="Visibility" Value="Visible"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=NavigationBorder, Path=Width}" Value="52">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </ListBoxItem>

                    <ListBoxItem Tag="Reports">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="32"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <materialDesign:PackIcon Grid.Column="0" Kind="ChartBar" Width="28" Height="28" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White"/>
                            <TextBlock Grid.Column="1" Text="Reports" VerticalAlignment="Center" Margin="12,0,0,0" Foreground="White" FontWeight="Medium" FontSize="16">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="Visibility" Value="Visible"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=NavigationBorder, Path=Width}" Value="52">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </ListBoxItem>

                    <Separator Style="{StaticResource MaterialDesignDarkSeparator}" Margin="12,8"/>

                    <ListBoxItem Tag="FinancialTransactions">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="32"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <materialDesign:PackIcon Grid.Column="0" Kind="CashMultiple" Width="28" Height="28" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White"/>
                            <TextBlock Grid.Column="1" Text="Financial Transactions" VerticalAlignment="Center" Margin="12,0,0,0" Foreground="White" FontWeight="Medium" FontSize="16">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="Visibility" Value="Visible"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=NavigationBorder, Path=Width}" Value="52">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </ListBoxItem>

                    <ListBoxItem Tag="Wages">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="32"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <materialDesign:PackIcon Grid.Column="0" Kind="AccountCash" Width="28" Height="28" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White"/>
                            <TextBlock Grid.Column="1" Text="Wages Management" VerticalAlignment="Center" Margin="12,0,0,0" Foreground="White" FontWeight="Medium" FontSize="16">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="Visibility" Value="Visible"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=NavigationBorder, Path=Width}" Value="52">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </ListBoxItem>

                    <Separator Style="{StaticResource MaterialDesignDarkSeparator}" Margin="12,8"/>

                    <ListBoxItem Tag="Items">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="32"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <materialDesign:PackIcon Grid.Column="0" Kind="Package" Width="28" Height="28" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White"/>
                            <TextBlock Grid.Column="1" Text="Items Management" VerticalAlignment="Center" Margin="12,0,0,0" Foreground="White" FontWeight="Medium" FontSize="16">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="Visibility" Value="Visible"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=NavigationBorder, Path=Width}" Value="52">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </ListBoxItem>

                    <ListBoxItem Tag="Parties">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="32"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <materialDesign:PackIcon Grid.Column="0" Kind="AccountGroup" Width="28" Height="28" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White"/>
                            <TextBlock Grid.Column="1" Text="Parties Management" VerticalAlignment="Center" Margin="12,0,0,0" Foreground="White" FontWeight="Medium" FontSize="16">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="Visibility" Value="Visible"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=NavigationBorder, Path=Width}" Value="52">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </ListBoxItem>

                    <Separator Style="{StaticResource MaterialDesignDarkSeparator}" Margin="12,8"/>

                    <ListBoxItem Tag="Backup">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="32"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <materialDesign:PackIcon Grid.Column="0" Kind="BackupRestore" Width="28" Height="28" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White"/>
                            <TextBlock Grid.Column="1" Text="Backup &amp; Restore" VerticalAlignment="Center" Margin="12,0,0,0" Foreground="White" FontWeight="Medium" FontSize="16">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="Visibility" Value="Visible"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=NavigationBorder, Path=Width}" Value="52">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </ListBoxItem>

                    <Separator Style="{StaticResource MaterialDesignDarkSeparator}" Margin="12,8"/>

                    <ListBoxItem Tag="Exit">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="32"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <materialDesign:PackIcon Grid.Column="0" Kind="ExitToApp" Width="28" Height="28" VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="White"/>
                            <TextBlock Grid.Column="1" Text="Exit" VerticalAlignment="Center" Margin="12,0,0,0" Foreground="White" FontWeight="Medium" FontSize="16">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="White"/>
                                        <Setter Property="Visibility" Value="Visible"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName=NavigationBorder, Path=Width}" Value="52">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </ListBoxItem>
                </ListBox>
            </DockPanel>
        </Border>

        <!-- Main Content Area -->
        <DockPanel Grid.Column="1">
            <!-- Top Bar -->
            <materialDesign:ColorZone Padding="32,20" 
                                     materialDesign:ElevationAssist.Elevation="Dp4"
                                     DockPanel.Dock="Top"
                                     Background="#2D2D30">
                <DockPanel>
                    <TextBlock HorizontalAlignment="Left" 
                             VerticalAlignment="Center" 
                             FontSize="22"
                             FontWeight="SemiBold"
                             Foreground="White"
                             Text="{Binding CurrentViewTitle}"/>
                    
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                        <materialDesign:PackIcon Kind="AccountCircle" 
                                               Width="24" 
                                               Height="24" 
                                               Foreground="White" 
                                               VerticalAlignment="Center"
                                               Margin="0,0,8,0"/>
                        <TextBlock Text="Admin" 
                                 FontSize="14" 
                                 Foreground="White" 
                                 FontWeight="Medium"
                                 VerticalAlignment="Center"/>
                    </StackPanel>
                </DockPanel>
            </materialDesign:ColorZone>

            <!-- Content Area with Unified Background -->
            <Grid Background="#1E1E1E">
                <ContentControl Content="{Binding CurrentView}" Margin="20">
                    <ContentControl.CacheMode>
                        <BitmapCache RenderAtScale="1" SnapsToDevicePixels="True"/>
                    </ContentControl.CacheMode>
                </ContentControl>
            </Grid>
        </DockPanel>
        </Grid>
    </Grid>
</Window>
